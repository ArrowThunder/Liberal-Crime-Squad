
#include "../includes.h"
const string CONST_justiceB174 = "hiring an undocumented worker";
const string CONST_justiceB173 = "hiring undocumented workers";
const string CONST_justice182 = " months.";
const string CONST_justice181 = " is due to be executed in ";
const string CONST_justice180 = " is due to be released next month.";
const string CONST_justice179 = " is due to be executed next month.";
const string CONST_justice178 = "No doubt there are some mental scars, but the Liberal is back.";
const string CONST_justice177 = " has been released from prison.";
const string CONST_justice176 = "If you can't protect your own people, who can you protect?";
const string CONST_justice175 = " has failed the Liberal Crime Squad.";
const string CONST_justice174 = "by ";
const string CONST_justice173 = "Today, the Conservative Machine executed ";
const string CONST_justice172 = "FOR SHAME:";
const string CONST_justice171 = "due to the abolition of the death penalty.";
const string CONST_justice170 = "'s death sentence has been commuted to life, ";
const string CONST_justice169 = " seems to be mostly fine, though.";
const string CONST_justice168 = " is kinda losing it in here. Juice, that is.";
const string CONST_justice167 = " has become a more hardened, Juicier criminal.";
const string CONST_justice166 = "The LCS will rise again! Multiple LCS members escape!";
const string CONST_justice165 = "Another imprisoned LCS member also gets out!";
const string CONST_justice164 = " escaped from prison!";
const string CONST_justice163 = " intentionally ODs on smuggled drugs, then breaks out of the medical ward!";
const string CONST_justice162 = " jimmies the cell door and cuts the outer fence in the dead of night!";
const string CONST_justice161 = " puts on smuggled street clothes and calmly walks out of prison.";
const string CONST_justice160 = " codes a virus on a smuggled phone that opens all the prison doors!";
const string CONST_justice159 = " leads a riot with dozens of prisoners chanting the LCS slogan!";
const string CONST_justice158 = " managed to avoid lasting injury.";
const string CONST_justice157 = " is found dead.";
const string CONST_justice156 = " is badly hurt in the process.";
const string CONST_justice152 = " consumes drugs that simulate death, and is thrown out with the trash!";
const string CONST_justice151 = " picks the lock on their leg chains and then sneaks away!";
const string CONST_justice150 = " wears an electrician's outfit and rides away with some contractors.";
const string CONST_justice149 = " leads the oppressed prisoners and overwhelms the prison guards!";
const string CONST_justice148 = " remains strong.";
const string CONST_justice147 = " abandons the Liberal Crime Squad!";
const string CONST_justice146 = " only stays loyal to the LCS for ";
const string CONST_justice145 = " silently grows Wiser...";
const string CONST_justice144 = " feels bad about LCS actions, and loses juice!";
const string CONST_justice143 = "The court accepts the plea.";
const string CONST_justice142 = "nolo";
const string CONST_justice141 = ", less a month for time already served.";
const string CONST_justice140 = " will be returned to prison to resume an earlier sentence";
const string CONST_justice139 = " is free!";
const string CONST_justice138 = "NOT GUILTY!";
const string CONST_justice134 = "The prosecution declines to re-try the case.";
const string CONST_justice133 = "The case will be re-tried next month.";
const string CONST_justice132 = "But they can't reach a verdict!";
const string CONST_justice131 = "The jury has returned from deliberations.";
const string CONST_justice130 = "The jury leaves to consider the case.";
const string CONST_justice129 = " to acquit)";
const string CONST_justice128 = ", need ";
const string CONST_justice127 = " (";
const string CONST_justice126 = " had the jury, judge, and prosecution crying for freedom.";
const string CONST_justice125 = " made a very powerful case.";
const string CONST_justice124 = " worked the jury very well.";
const string CONST_justice123 = "'s arguments were pretty good.";
const string CONST_justice122 = " did all right, but made some mistakes.";
const string CONST_justice121 = "'s case really sucked.";
const string CONST_justice120 = " makes one horrible mistake after another.";
const string CONST_justice119 = " conducts an incredible defense.";
const string CONST_justice118 = "and shout \"NOT GUILTY!\" before deliberations even began.";
const string CONST_justice117 = "'s arguments made several of the jurors stand up ";
const string CONST_justice116 = "The defense is extremely compelling.";
const string CONST_justice115 = "The defense makes the prosecution look like amateurs.";
const string CONST_justice114 = "The defense was really slick.";
const string CONST_justice113 = "Defense arguments were pretty good.";
const string CONST_justice112 = "The defense was lackluster.";
const string CONST_justice111 = "The defense is totally lame.";
const string CONST_justice110 = "The defense attorney accidentally said \"My client is GUILTY!\" during closing.";
const string CONST_justice109 = "The defense attorney rarely showed up.";
const string CONST_justice108 = " to convict)";
const string CONST_justice107 = " to +";
const string CONST_justice106 = " (+";
const string CONST_justice105 = "The prosecution is incredibly strong.";
const string CONST_justice104 = "The prosecution makes an airtight case.";
const string CONST_justice103 = "The prosecution's case is solid.";
const string CONST_justice102 = "The prosecution gives a standard presentation.";
const string CONST_justice101 = "The prosecution's presentation is terrible.";
const string CONST_justice098 = "The jury is a bit Conservative.";
const string CONST_justice097 = "The jury is quite moderate.";
const string CONST_justice096 = "The jury is fairly Liberal.";
const string CONST_justice095 = "'s best friend from childhood is a juror.";
const string CONST_justice094 = "'s CONSERVATIVE ARCH-NEMESIS will represent the prosecution!!!";
const string CONST_justice093 = "'s favor!";
const string CONST_justice092 = " ensures the jury is stacked in ";
const string CONST_justice091 = "The trial proceeds.  Jury selection is first.";
const string CONST_justice090 = " is standing trial.";
const string CONST_justice089 = "Intelligence: ";
const string CONST_justice088 = "Law: ";
const string CONST_justice087 = "Charisma: ";
const string CONST_justice086 = "Persuasion: ";
const string CONST_justice085 = "Heart: ";
const string CONST_justice084 = "'s offer to assist pro bono.";
const string CONST_justice083 = "E - Accept sleeper ";
const string CONST_justice082 = "D - Pay $5000 to hire ace Liberal attorney ";
const string CONST_justice081 = "C - Plead guilty.";
const string CONST_justice080 = "B - Defend self!";
const string CONST_justice079 = "A - Use a court-appointed attorney.";
const string CONST_justice078 = "How will you conduct the defense?";
const string CONST_justice077 = "A former LCS member will testify against ";
const string CONST_justice076 = " former LCS members will testify against ";
const string CONST_justice075 = "loitering";
const string CONST_justice074 = "indecent exposure";
const string CONST_justice073 = "disturbing the peace";
const string CONST_justice072 = "resisting arrest";
const string CONST_justice071 = "vandalism";
const string CONST_justice070 = "breaking and entering";
const string CONST_justice069 = "unlawful burial";
const string CONST_justice068 = "unlawful access of an information system";
const string CONST_justice067 = "interference with interstate commerce";
const string CONST_justice066 = "possession of an illegal weapon";
const string CONST_justice065 = "firing an illegal weapon";
const string CONST_justice064 = "hiring an illegal alien";
const string CONST_justice063 = "hiring illegal aliens";
const string CONST_justice062 = "prostitution";
const string CONST_justice061 = "petty larceny";
const string CONST_justice060 = "credit card fraud";
const string CONST_justice059 = "grand theft auto";
const string CONST_justice058 = "misdemeanor assault";
const string CONST_justice057 = "felony assault";
const string CONST_justice056 = "extortion";
const string CONST_justice055 = "racketeering";
const string CONST_justice054 = "jury tampering";
const string CONST_justice053 = "aiding a prison escape";
const string CONST_justice052 = "escaping prison";
const string CONST_justice051 = "drug dealing";
const string CONST_justice050 = "sedition";
const string CONST_justice049 = "flag burning";
const string CONST_justice048 = "felony flag burning";
const string CONST_justice047 = "Flag Murder";
const string CONST_justice046 = "arson";
const string CONST_justice045 = "bank robbery";
const string CONST_justice044 = "kidnapping";
const string CONST_justice043 = "murder";
const string CONST_justice042 = "terrorism";
const string CONST_justice041 = "treason";
const string CONST_justice040 = ", is charged with ";
const string CONST_justice039 = "The defendant, ";
const string CONST_justice038 = "The judge reads the charges:";
const string CONST_justice037 = " reads the charges, trying to hide a smile:";
const string CONST_justice035 = "to be served consecutively";
const string CONST_justice034 = "to be served concurrently";
const string CONST_justice033 = ",";
const string CONST_justice032 = " in prison";
const string CONST_justice031 = "s";
const string CONST_justice030 = " month";
const string CONST_justice029 = " years in prison";
const string CONST_justice028 = "life in prison";
const string CONST_justice027 = "Have a nice day, ";
const string CONST_justice026 = " consecutive life terms in prison";
const string CONST_justice025 = ", you are sentenced to ";
const string CONST_justice024 = ", consider this a warning.  You are free to go.";
const string CONST_justice022 = "You will be returned to prison to resume it";
const string CONST_justice021 = ", the court sees no need to add to your existing sentence.";
const string CONST_justice020 = ", you are sentenced to DEATH!";
const string CONST_justice019 = ", you will be returned to prison to carry out your death sentence.";
const string CONST_justice018 = "During sentencing, the judge grants some leniency.";
const string CONST_justice017 = "GUILTY!";
const string CONST_justice016 = "general_experiences.txt";
const string CONST_justice015 = "bad_experiences.txt";
const string CONST_justice014 = "good_experiences.txt";
const string CONST_justice013 = "labor_camp_experiences.txt";
const string CONST_justice012 = "reeducation_experiences.txt";
const string CONST_justice011 = "supposedly_painless_execution_method.txt";
const string CONST_justice010 = "standard_execution_methods.txt";
const string CONST_justice009 = "cruel_and_unusual_execution_methods.txt";
const string CONST_justice008 = "conservative_jury.txt";
const string CONST_justice007 = "liberal_jury.txt";

const string tag_ARMOR = "ARMOR";
const string tag_ARMOR_CLOTHES = "ARMOR_CLOTHES";
const string tag_ARMOR_WORKCLOTHES = "ARMOR_WORKCLOTHES";
/*
Copyright (c) 2002,2003,2004 by Tarn Adams                                            //
                                                                                      //
This file is part of Liberal Crime Squad.                                             //
                                                                                    //
    Liberal Crime Squad is free software; you can redistribute it and/or modify     //
    it under the terms of the GNU General Public License as published by            //
    the Free Software Foundation; either version 2 of the License, or               //
    (at your option) any later version.                                             //
                                                                                    //
    Liberal Crime Squad is distributed in the hope that it will be useful,          //
    but WITHOUT ANY WARRANTY; without even the implied warranty of                  //
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.   See the                  //
    GNU General Public License for more details.                                    //
                                                                                    //
    You should have received a copy of the GNU General Public License               //
    along with Liberal Crime Squad; if not, write to the Free Software              //
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA   02111-1307   USA     //
*/
/*
        This file was created by Chris Johnson (grundee@users.sourceforge.net)
        by copying code from game.cpp.
        To see descriptions of files and functions, see the list at
        the bottom of includes.h in the top src folder.
*/
const string blankString = "";
const string tag_value = "value";
const string tag_attribute = "attribute";
const string tag_skill = "skill";
#include "../creature/creature.h"
#include "../locations/locations.h"
#include "../common/ledgerEnums.h"
#include "../common/ledger.h"
#include "../log/log.h"
//#include "../common/commonactions.h"
int scare_factor(int lawflag, int crimenumber);
#include "../common/commonactionsCreature.h"
// for  bool iscriminal(Creature &)
#include "../common/translateid.h"
// for  int getarmortype
#include "../politics/politics.h"
//for publicmood
#include "../cursesAlternative.h"
#include "../set_color_support.h"
#include "../common/creaturePoolCreature.h"
 vector<string> liberal_jury;
 vector<string> conservative_jury;
 vector<string> cruel_and_unusual_execution_methods;
 vector<string> standard_execution_methods;
 vector<string> supposedly_painless_execution_method;
 vector<string> reeducation_experiences;
 vector<string> labor_camp_experiences;
 vector<string> good_experiences;
 vector<string> bad_experiences;
 vector<string> general_experiences;
#include "../customMaps.h"
 const string justice = "justice\\";
 vector<file_and_text_collection> justice_text_file_collection = {
	 /*justice.cpp*/
	 customText(&liberal_jury, justice + CONST_justice007),
	 customText(&conservative_jury, justice + CONST_justice008),
	 customText(&cruel_and_unusual_execution_methods, justice + CONST_justice009),
	 customText(&standard_execution_methods, justice + CONST_justice010),
	 customText(&supposedly_painless_execution_method, justice + CONST_justice011),
	 customText(&reeducation_experiences, justice + CONST_justice012),
	 customText(&labor_camp_experiences, justice + CONST_justice013),
	 customText(&good_experiences, justice + CONST_justice014),
	 customText(&bad_experiences, justice + CONST_justice015),
	 customText(&general_experiences, justice + CONST_justice016),
 };
#include "../common/musicClass.h"
 string counts_of; 
extern string string_sleeper;
extern string singleDot;
extern string AND;
extern string commaSpace;
extern string singleSpace;
 string execution_in_three_months;
#include "../common/creaturePool.h"
#include "../locations/locationsPool.h"
 /* monthly - sentence a liberal */
 void calculateSentence(DeprecatedCreature &g, const char lenient) {
	 extern short lawList[LAWNUM];
	 if (!(g.sentence < 0))
	 {
		 g.sentence += (36 + LCSrandom(18))*g.crimes_suspected[LAWFLAG_KIDNAPPING];
		 g.sentence += (1 + LCSrandom(4))*g.crimes_suspected[LAWFLAG_THEFT];
		 //g.sentence+=(4+LCSrandom(12))*(!!g.crimes_suspected[LAWFLAG_GUNUSE])+ // Extra for first incident only
		 //            (2+LCSrandom(4)*g.crimes_suspected[LAWFLAG_GUNUSE]);      // Generally
		 //g.sentence+=(1+LCSrandom(4))*(!!g.crimes_suspected[LAWFLAG_GUNCARRY]);
		 g.sentence += (6 + LCSrandom(7))*g.crimes_suspected[LAWFLAG_CARTHEFT];
		 g.sentence += (1 + LCSrandom(13))*g.crimes_suspected[LAWFLAG_INFORMATION];
		 g.sentence += (1 + LCSrandom(13))*g.crimes_suspected[LAWFLAG_COMMERCE];
		 g.sentence += (6 + LCSrandom(25))*g.crimes_suspected[LAWFLAG_CCFRAUD];
		 g.sentence += (3 + LCSrandom(12))*g.crimes_suspected[LAWFLAG_BURIAL];
		 g.sentence += (1 + LCSrandom(6))*g.crimes_suspected[LAWFLAG_PROSTITUTION];
		 g.sentence += 1 * g.crimes_suspected[LAWFLAG_DISTURBANCE];
		 g.sentence += 1 * g.crimes_suspected[LAWFLAG_PUBLICNUDITY];
		 //g.sentence+=1*g.crimes_suspected[LAWFLAG_LOITERING];
		 g.sentence += 1 * g.crimes_suspected[LAWFLAG_HIREILLEGAL];
		 g.sentence += (12 + LCSrandom(100))*g.crimes_suspected[LAWFLAG_RACKETEERING];
		 // How illegal is marijuana?
		 if (lawList[LAW_DRUGS] == -2) g.sentence += (3 + LCSrandom(360))*g.crimes_suspected[LAWFLAG_BROWNIES]; //insanely illegal
		 else if (lawList[LAW_DRUGS] == -1) g.sentence += (3 + LCSrandom(120))*g.crimes_suspected[LAWFLAG_BROWNIES]; //very illegal
		 else if (lawList[LAW_DRUGS] == 0) g.sentence += (3 + LCSrandom(12))*g.crimes_suspected[LAWFLAG_BROWNIES]; //moderately illegal
																												   // else not illegal
		 g.sentence += 1 * g.crimes_suspected[LAWFLAG_BREAKING];
		 g.sentence += (60 + LCSrandom(181))*g.crimes_suspected[LAWFLAG_TERRORISM];
		 g.sentence += (30 + LCSrandom(61))*g.crimes_suspected[LAWFLAG_BANKROBBERY];
		 g.sentence += (30 + LCSrandom(61))*g.crimes_suspected[LAWFLAG_JURY];
		 g.sentence += (30 + LCSrandom(61))*g.crimes_suspected[LAWFLAG_HELPESCAPE];
		 g.sentence += (3 + LCSrandom(16))*g.crimes_suspected[LAWFLAG_ESCAPED];
		 g.sentence += (1 + LCSrandom(1))*g.crimes_suspected[LAWFLAG_RESIST];
		 g.sentence += (6 + LCSrandom(1))*g.crimes_suspected[LAWFLAG_EXTORTION];
		 g.sentence += (4 + LCSrandom(3))*g.crimes_suspected[LAWFLAG_SPEECH];
		 g.sentence += 1 * g.crimes_suspected[LAWFLAG_VANDALISM];
		 g.sentence += (12 + LCSrandom(12))*g.crimes_suspected[LAWFLAG_ARSON];
		 g.sentence += (12 + LCSrandom(1))*g.crimes_suspected[LAWFLAG_ARMEDASSAULT];
		 g.sentence += (3 + LCSrandom(1))*g.crimes_suspected[LAWFLAG_ASSAULT];
	 }
	 if (lawList[LAW_FLAGBURNING] == -2)
	 {
		 if (!LCSrandom(2)) g.sentence += (120 + LCSrandom(241))*g.crimes_suspected[LAWFLAG_BURNFLAG];
		 else if (g.crimes_suspected[LAWFLAG_BURNFLAG])g.sentence = -1 * g.crimes_suspected[LAWFLAG_BURNFLAG];
	 }
	 else if (lawList[LAW_FLAGBURNING] == -1) g.sentence += 36 * g.crimes_suspected[LAWFLAG_BURNFLAG];
	 else if (lawList[LAW_FLAGBURNING] == 0) g.sentence += 1 * g.crimes_suspected[LAWFLAG_BURNFLAG];
	 if ((LCSrandom(4) - g.crimes_suspected[LAWFLAG_MURDER]) > 0)
	 {
		 if (!(g.sentence < 0)) g.sentence += (120 + LCSrandom(241))*g.crimes_suspected[LAWFLAG_MURDER];
	 }
	 else
	 {
		 if (g.sentence < 0) g.sentence -= -1 * g.crimes_suspected[LAWFLAG_MURDER];
		 else if (g.crimes_suspected[LAWFLAG_MURDER])
			 g.sentence = -1 * g.crimes_suspected[LAWFLAG_MURDER];
	 }
	 if (g.sentence < 0) g.sentence -= 1 * g.crimes_suspected[LAWFLAG_TREASON];
	 else if (g.crimes_suspected[LAWFLAG_TREASON]) g.sentence = -1 * g.crimes_suspected[LAWFLAG_TREASON];
	 if (lenient&&g.sentence != -1) g.sentence /= 2;
	 if (lenient&&g.sentence == -1) g.sentence = 240 + LCSrandom(120);
 }
// string counts_of;
// string execution_in_three_months;
 /* monthly - sentence a liberal */
 void penalize(DeprecatedCreature &g, const char lenient)
 {
	 extern Log gamelog;
	 extern short lawList[LAWNUM];
	 set_color_easy(RED_ON_BLACK_BRIGHT);
	 mvaddstrAlt(3, 1, CONST_justice017, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 short oldsentence = g.sentence;
	 char olddeathpenalty = g.deathpenalty;
	 g.sentence = 0, g.deathpenalty = 0;
	 if (!lenient && ((g.crimes_suspected[LAWFLAG_MURDER]) || (g.crimes_suspected[LAWFLAG_TREASON]) ||
		 ((g.crimes_suspected[LAWFLAG_BURNFLAG]) && lawList[LAW_FLAGBURNING] == -2) ||
		 lawList[LAW_DEATHPENALTY] == -2))
	 {
		 if (lawList[LAW_DEATHPENALTY] == -2) g.deathpenalty = 1;
		 if (lawList[LAW_DEATHPENALTY] == -1) g.deathpenalty = LCSrandom(3);
		 if (lawList[LAW_DEATHPENALTY] == 0) g.deathpenalty = LCSrandom(2);
		 if (lawList[LAW_DEATHPENALTY] == 1) g.deathpenalty = !LCSrandom(5);
		 if (lawList[LAW_DEATHPENALTY] == 2) g.deathpenalty = 0;
	 }
	 for (int l = 0; l < LAWFLAGNUM; l++) {
		 if (g.crimes_suspected[l] > 10) {
			 g.crimes_suspected[l] = 10;
		 }
	 }
	 //CALC TIME
	 if (!g.deathpenalty)
	 {
		 calculateSentence(g, lenient);
	 }
	 //LENIENCY AND CAPITAL PUNISHMENT DON'T MIX
	 else if (g.deathpenalty&&lenient) g.deathpenalty = 0, g.sentence = -1;
	 //MENTION LENIENCY
	 if (lenient)
	 {
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(5, 1, CONST_justice018, gamelog);
		 gamelog.newline();
		 pressAnyKey();
	 }
	 //MENTION SENTENCE
	 if (olddeathpenalty)
	 {
		 g.deathpenalty = 1;
		 g.sentence = 3;
		 set_color_easy(RED_ON_BLACK_BRIGHT);
		 mvaddstrAlt(7, 1, g.propername, gamelog);
		 addstrAlt(CONST_justice019, gamelog);
		 gamelog.newline();
		 pressAnyKey();
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(9, 1, execution_in_three_months, gamelog);
		 pressAnyKey();
	 }
	 else if (g.deathpenalty)
	 {
		 g.sentence = 3;
		 set_color_easy(YELLOW_ON_RED_BRIGHT);
		 mvaddstrAlt(7, 1, g.propername, gamelog);
		 addstrAlt(CONST_justice020, gamelog);
		 gamelog.newline();
		 pressAnyKey();
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(9, 1, execution_in_three_months, gamelog);
		 pressAnyKey();
	 }
	 // Don't give a time-limited sentence if they already have a life sentence.
	 else if ((g.sentence >= 0 && oldsentence < 0) ||
		 (g.sentence == 0 && oldsentence > 0))
	 {
		 g.sentence = oldsentence;
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(7, 1, g.propername, gamelog);
		 addstrAlt(CONST_justice021, gamelog);
		 mvaddstrAlt(8, 1, CONST_justice022, gamelog);
		 if (g.sentence > 1 && lenient)
		 {
			 g.sentence--;
			 addstrAlt(CONST_justice141, gamelog);
		 }
		 else addstrAlt(singleDot, gamelog);
		 pressAnyKey();
	 }
	 else if (g.sentence == 0)
	 {
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(7, 1, g.propername, gamelog);
		 addstrAlt(CONST_justice024, gamelog);
		 pressAnyKey();
	 }
	 else
	 {
		 if (g.sentence >= 36)g.sentence -= g.sentence % 12;
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(7, 1, g.propername, gamelog);
		 addstrAlt(CONST_justice025, gamelog);
		 if (g.sentence > 1200) g.sentence /= -1200;
		 if (g.sentence <= -1)
		 {
			 if (g.sentence < -1)
			 {
				 addstrAlt(-(g.sentence), gamelog);
				 addstrAlt(CONST_justice026, gamelog);
				 gamelog.newline();
				 // Don't bother saying this if the convicted already has one or
				 // more life sentences. Makes the 'consecutively' and 'concurrently'
				 // statements later easier to tack on.
				 if (oldsentence >= 0)
				 {
					 addstrAlt(singleDot, gamelog);
					 pressAnyKey();
					 mvaddstrAlt(9, 1, CONST_justice027, gamelog);
					 addstrAlt(g.propername, gamelog);
				 }
			 }
			 else addstrAlt(CONST_justice028, gamelog);
		 }
		 else if (g.sentence >= 36)
		 {
			 addstrAlt(g.sentence / 12, gamelog);
			 addstrAlt(CONST_justice029, gamelog);
		 }
		 else
		 {
			 addstrAlt(g.sentence, gamelog);
			 addstrAlt(CONST_justice030, gamelog);
			 if (g.sentence > 1)addstrAlt(CONST_justice031, gamelog);
			 addstrAlt(CONST_justice032, gamelog);
		 }
		 // Mash together compatible sentences.
		 if ((g.sentence > 0 && oldsentence > 0) ||
			 (g.sentence < 0 && oldsentence < 0))
		 {
			 addstrAlt(CONST_justice033, gamelog);
			 moveAlt(8, 1);
			 if (lenient)
			 {
				 if (abs(oldsentence) > abs(g.sentence))
					 g.sentence = oldsentence;
				 addstrAlt(CONST_justice034, gamelog);
			 }
			 else
			 {
				 g.sentence += oldsentence;
				 addstrAlt(CONST_justice035, gamelog);
			 }
		 }
		 addstrAlt(singleDot, gamelog);
		 //dejuice boss
		 dejuiceBoss(g);
		 pressAnyKey();
	 }
	 gamelog.nextMessage();
 }
 /* monthly - move a liberal to jail */
 void imprison(DeprecatedCreature &g)
 {
	 g.location = find_site_index_in_city(SITE_GOVERNMENT_PRISON, LocationsPool::getInstance().get_specific_integer(INT_GETLOCATIONCITY,g.location));
 }
 string commaAndPunctuation(const int typenum) {
	 if (typenum > 1) return commaSpace;
	 if (typenum == 1) return AND;
	 if (typenum == 0) return singleDot;
	 else return blankString;
 }
 void printSingleCrime(DeprecatedCreature &g, const Lawflags law_flag, const int typenum, const string crime_string, const bool mention_multiple_counts = false);
 void printSingleCrime(DeprecatedCreature &g, const Lawflags law_flag, const int typenum, const string crime_string, const bool mention_multiple_counts) {
	 extern Log gamelog;
	 if (mention_multiple_counts && g.crimes_suspected[law_flag] > 1)
	 {
		 addstrAlt(g.crimes_suspected[law_flag], gamelog);
		 addstrAlt(counts_of, gamelog);
	 }
	 addstrAlt(crime_string, gamelog);
	 addstrAlt(commaAndPunctuation(typenum), gamelog);
	 pressAnyKey();
 }
 map<Lawflags, string> crimeBlockOne = {
	 map<Lawflags, string>::value_type(LAWFLAG_TREASON, CONST_justice041),
	 map<Lawflags, string>::value_type(LAWFLAG_TERRORISM, CONST_justice042),
	 map<Lawflags, string>::value_type(LAWFLAG_MURDER, CONST_justice043),
	 map<Lawflags, string>::value_type(LAWFLAG_KIDNAPPING, CONST_justice044),
	 map<Lawflags, string>::value_type(LAWFLAG_BANKROBBERY, CONST_justice045),
	 map<Lawflags, string>::value_type(LAWFLAG_ARSON, CONST_justice046),
 };
 map<Lawflags, string> crimeBlockTwo = {
	 map<Lawflags, string>::value_type(LAWFLAG_SPEECH, CONST_justice050),
	 map<Lawflags, string>::value_type(LAWFLAG_BROWNIES, CONST_justice051),
	 map<Lawflags, string>::value_type(LAWFLAG_ESCAPED, CONST_justice052),
	 map<Lawflags, string>::value_type(LAWFLAG_HELPESCAPE, CONST_justice053),
	 map<Lawflags, string>::value_type(LAWFLAG_JURY, CONST_justice054),
	 map<Lawflags, string>::value_type(LAWFLAG_RACKETEERING, CONST_justice055),
	 map<Lawflags, string>::value_type(LAWFLAG_EXTORTION, CONST_justice056),
	 map<Lawflags, string>::value_type(LAWFLAG_ARMEDASSAULT, CONST_justice057),
	 map<Lawflags, string>::value_type(LAWFLAG_ASSAULT, CONST_justice058),
	 map<Lawflags, string>::value_type(LAWFLAG_CARTHEFT, CONST_justice059),
	 map<Lawflags, string>::value_type(LAWFLAG_CCFRAUD, CONST_justice060),
	 map<Lawflags, string>::value_type(LAWFLAG_THEFT, CONST_justice061),
	 map<Lawflags, string>::value_type(LAWFLAG_PROSTITUTION, CONST_justice062),
 };
 map<Lawflags, string> crimeBlockThree = {
	 map<Lawflags, string>::value_type(LAWFLAG_COMMERCE, CONST_justice067),
	 map<Lawflags, string>::value_type(LAWFLAG_INFORMATION, CONST_justice068),
	 map<Lawflags, string>::value_type(LAWFLAG_BURIAL, CONST_justice069),
	 map<Lawflags, string>::value_type(LAWFLAG_BREAKING, CONST_justice070),
	 map<Lawflags, string>::value_type(LAWFLAG_VANDALISM, CONST_justice071),
	 map<Lawflags, string>::value_type(LAWFLAG_RESIST, CONST_justice072),
	 map<Lawflags, string>::value_type(LAWFLAG_DISTURBANCE, CONST_justice073),
	 map<Lawflags, string>::value_type(LAWFLAG_PUBLICNUDITY, CONST_justice074),
	 map<Lawflags, string>::value_type(LAWFLAG_LOITERING, CONST_justice075),
 };
 map<Lawflags, bool> crimeMultipleCounts = {
	 map<Lawflags, bool>::value_type(LAWFLAG_TREASON,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_TERRORISM,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_MURDER,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_KIDNAPPING,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_BANKROBBERY,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_ARSON,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_SPEECH,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_BROWNIES,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_ESCAPED,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_HELPESCAPE,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_JURY,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_RACKETEERING, false),
	 map<Lawflags, bool>::value_type(LAWFLAG_EXTORTION,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_ARMEDASSAULT,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_ASSAULT,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_CARTHEFT,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_CCFRAUD,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_THEFT,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_PROSTITUTION,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_COMMERCE,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_INFORMATION,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_BURIAL,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_BREAKING,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_VANDALISM,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_RESIST, false),
	 map<Lawflags, bool>::value_type(LAWFLAG_DISTURBANCE,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_PUBLICNUDITY,  true),
	 map<Lawflags, bool>::value_type(LAWFLAG_LOITERING, false),
 };
 int listAllCrimes(DeprecatedCreature &g) {

	 extern Log gamelog;
	 extern short lawList[LAWNUM];

	 int typenum = 0;
	 for (int i = 0; i < LAWFLAGNUM; i++) {
		 if (g.crimes_suspected[i])
		 {
			 typenum++;
		 }
	 }
	 int x = 2;
	 int y = 5;
	 if ((x++) >= 2) { x = 0; moveAlt(++y, 1); }

	 for (std::pair<Lawflags, string> element : crimeBlockOne) {

		 if (g.crimes_suspected[element.first]) {
			 printSingleCrime(g, element.first, typenum, element.second, crimeMultipleCounts[element.first]);
			 if ((x++) >= 2) { x = 0; moveAlt(++y, 1); }
		 }
	 }

	 if (g.crimes_suspected[LAWFLAG_BURNFLAG] && lawList[LAW_FLAGBURNING] <= 0)
	 {
		 string crime;
		 if (lawList[LAW_FLAGBURNING] == -2)
			 crime = (CONST_justice047);
		 else if (lawList[LAW_FLAGBURNING] == -1)
			 crime = (CONST_justice048);
		 else if (lawList[LAW_FLAGBURNING] == 0)
			 crime = (CONST_justice049);
		 // otherwise, not a crime
		 printSingleCrime(g, LAWFLAG_BURNFLAG, typenum, crime, true);
		 if ((x++) >= 2) { x = 0; moveAlt(++y, 1); }
	 }

	 for (std::pair<Lawflags, string> element : crimeBlockTwo) {

		 if (g.crimes_suspected[element.first]) {
			 typenum--;
			 printSingleCrime(g, element.first, typenum, element.second, crimeMultipleCounts[element.first]);
			 if ((x++) >= 2) { x = 0; moveAlt(++y, 1); }
		 }
	 }

	 if (g.crimes_suspected[LAWFLAG_HIREILLEGAL])
	 {
		 if (g.crimes_suspected[LAWFLAG_HIREILLEGAL] > 1)
		 {
			 addstrAlt(g.crimes_suspected[LAWFLAG_HIREILLEGAL], gamelog);
			 addstrAlt(counts_of, gamelog);
			 addstrAlt((lawList[LAW_IMMIGRATION] < 1 ? CONST_justice063 : CONST_justiceB173), gamelog);
		 }
		 else addstrAlt((lawList[LAW_IMMIGRATION] < 1 ? CONST_justice064 : CONST_justiceB174), gamelog);
		 x = 2;
		 typenum--;
		 addstrAlt(commaAndPunctuation(typenum), gamelog);
		 pressAnyKey();
		 if ((x++) >= 2) { x = 0; moveAlt(++y, 1); }
	 }

	 for (std::pair<Lawflags, string> element : crimeBlockThree) {

		 if (g.crimes_suspected[element.first]) {
			 typenum--;
			 printSingleCrime(g, element.first, typenum, element.second, crimeMultipleCounts[element.first]);
			 if ((x++) >= 2) { x = 0; moveAlt(++y, 1); }
		 }
	 }

	 return y;

 }
 enum LegalDefense {
	 UNDECIDED = -1,
	 COURT_ATTORNEY = 0,
	 SELF_REPRESENT = 1,
	 PLEAD_GUILTY = 2,
	 ACE_ATTORNEY = 3,
	 SLEEPER_ATTORNEY = 4
 };
 void acquittal(DeprecatedCreature &g, DeprecatedCreature &sleeperLawyer, const LegalDefense defense, const bool sleeperjudge) {
	 extern Log gamelog;
	 DeprecatedCreature *sleeperlawyer = &sleeperLawyer;
	 set_color_easy(GREEN_ON_BLACK_BRIGHT);
	 mvaddstrAlt(3, 1, CONST_justice138, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 if (g.sentence == 0)
	 {
		 set_color_easy(GREEN_ON_BLACK_BRIGHT);
		 mvaddstrAlt(5, 1, g.name, gamelog);
		 addstrAlt(CONST_justice139, gamelog);
	 }
	 else
	 {
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(5, 1, g.name, gamelog);
		 addstrAlt(CONST_justice140, gamelog);
		 if (!g.deathpenalty && g.sentence > 1 && (LCSrandom(2) || sleeperjudge))
		 {
			 g.sentence--;
			 addstrAlt(CONST_justice141, gamelog);
		 }
		 else addstrAlt(singleDot, gamelog);
		 if (g.deathpenalty)
		 {
			 g.sentence = 3;
			 mvaddstrAlt(7, 1, execution_in_three_months, gamelog);
		 }
	 }
	 gamelog.nextMessage();
	 // Juice sleeper
	 if (defense == SLEEPER_ATTORNEY) addjuice(*sleeperlawyer, 10, 100);
	 // Juice for self-defense
	 if (defense == SELF_REPRESENT) addjuice(g, 10, 100);
	 pressAnyKey();
 }
 bool hung_jury(DeprecatedCreature &g, const bool sleeperjudge, const int scarefactor) {
	 extern Log gamelog;
	 bool keeplawflags = false;
	 set_color_easy(YELLOW_ON_BLACK_BRIGHT);
	 mvaddstrAlt(3, 1, CONST_justice132, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 //RE-TRY
	 if (LCSrandom(2) || scarefactor >= 10 || g.confessions)
	 {
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(5, 1, CONST_justice133, gamelog);
		 gamelog.newline();
		 pressAnyKey();
		 g.location = find_site_index_in_same_city(SITE_GOVERNMENT_COURTHOUSE, g.location);
		 keeplawflags = true;
	 }
	 //NO RE-TRY
	 else
	 {
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(5, 1, CONST_justice134, gamelog);
		 gamelog.newline();
		 if (g.sentence == 0)
		 {
			 set_color_easy(GREEN_ON_BLACK_BRIGHT);
			 mvaddstrAlt(7, 1, g.name, gamelog);
			 addstrAlt(CONST_justice139, gamelog);
		 }
		 else
		 {
			 set_color_easy(WHITE_ON_BLACK);
			 mvaddstrAlt(7, 1, g.name, gamelog);
			 addstrAlt(CONST_justice140, gamelog);
			 if (!g.deathpenalty && g.sentence > 1 && (LCSrandom(2) || sleeperjudge))
			 {
				 g.sentence--;
				 addstrAlt(CONST_justice141, gamelog);
			 }
			 else addstrAlt(singleDot, gamelog);
			 if (g.deathpenalty)
			 {
				 g.sentence = 3;
				 mvaddstrAlt(9, 1, execution_in_three_months, gamelog);
			 }
		 }
		 gamelog.nextMessage();
		 pressAnyKey();
	 }
	 return keeplawflags;
 }
 void printdefensepower(const int defensepower) {
	 extern Log gamelog;

	 if (defensepower <= 5) { addstrAlt(CONST_justice109, gamelog); }
	 else if (defensepower <= 15) { addstrAlt(CONST_justice110, gamelog); }
	 else if (defensepower <= 25) { addstrAlt(CONST_justice111, gamelog); }
	 else if (defensepower <= 50) { addstrAlt(CONST_justice112, gamelog); }
	 else if (defensepower <= 75) { addstrAlt(CONST_justice113, gamelog); }
	 else /*if (defensepower <= 100)*/ { addstrAlt(CONST_justice114, gamelog); }
 }
 void printstrongdefensepower(const int prosecution) {
	 extern Log gamelog;


	 if (prosecution < 100) { addstrAlt(CONST_justice115, gamelog); }
	 else { addstrAlt(CONST_justice116, gamelog); }

 }
 void printultimatedefensepower(const int prosecution, const string attorneyname) {
	 extern Log gamelog;
	 if (prosecution < 100)
	 {
		 addstrAlt(attorneyname, gamelog);
		 addstrAlt(CONST_justice117, gamelog);
		 mvaddstrAlt(10, 1, CONST_justice118, gamelog);
	 }
	 else
	 {
		 addstrAlt(attorneyname, gamelog);
		 addstrAlt(CONST_justice119, gamelog);
	 }
 }
 int get_defensepower(DeprecatedCreature &g, DeprecatedCreature &sleeperLawyer, const char attorneyname[200], const LegalDefense defense, const int prosecution) {
	 extern Log gamelog;
	 DeprecatedCreature *sleeperlawyer = &sleeperLawyer;
	 int defensepower = 0;
	 if (defense == COURT_ATTORNEY || defense == ACE_ATTORNEY || defense == SLEEPER_ATTORNEY)
	 {


		 if (defense == COURT_ATTORNEY) defensepower = LCSrandom(71);    // Court-appointed attorney
		 else if (defense == ACE_ATTORNEY) defensepower = LCSrandom(71) + 80; // Ace Liberal attorney
		 else if (defense == SLEEPER_ATTORNEY)
		 {
			 // Sleeper attorney
			 defensepower = LCSrandom(71) + sleeperlawyer->get_skill(SKILL_LAW) * 2
				 + sleeperlawyer->get_skill(SKILL_PERSUASION) * 2;
			 sleeperlawyer->train(SKILL_LAW, prosecution / 4);
			 sleeperlawyer->train(SKILL_PERSUASION, prosecution / 4);
		 }
		 if (defensepower <= 100) { printdefensepower(defensepower); }
		 else if (defensepower <= 145) { printstrongdefensepower(prosecution); }
		 else
		 {
			 printultimatedefensepower(prosecution, attorneyname);
		 }
		 if (defense == SLEEPER_ATTORNEY && defensepower > 145 && prosecution < 100) {
			 addjuice(*sleeperlawyer, 10, 500); // Bow please
		 }
		 gamelog.newline();

	 }
	 if (defense == SELF_REPRESENT)
	 {
		 // *JDS* LEGAL SELF-REPRESENTATION: To succeed here, you really need to have two skills be
		 // high: persuasion and law, with law being 1.5 times as influential. You can't have
		 // just one or just the other. Even if you're a very persuasive person, the court will eat
		 // you alive if you can't sound intelligent when talking about the relevant charges, and you
		 // won't be able to fool the jury into letting you go if you aren't persuasive, as no
		 // matter how encyclopedic your legal knowledge is, it's all in the pitch.
		 //
		 // If either your persuasion or your law roll is too low, you'll end up getting a negative
		 // result that will drag down your defense. So try not to suck in either area.
		 defensepower = 5 * (g.skill_roll(SKILL_PERSUASION) - 3) +
			 10 * (g.skill_roll(SKILL_LAW) - 3);
		 g.train(SKILL_PERSUASION, 50);
		 g.train(SKILL_LAW, 50);
		 addstrAlt(g.name, gamelog);
		 if (defensepower <= 0)
		 {
			 addstrAlt(CONST_justice120, gamelog);
			 gamelog.newline();
			 addjuice(g, -10, -50); // You should be ashamed
		 }
		 else if (defensepower <= 25) addstrAlt(CONST_justice121, gamelog);
		 else if (defensepower <= 50) addstrAlt(CONST_justice122, gamelog);
		 else if (defensepower <= 75) addstrAlt(CONST_justice123, gamelog);
		 else if (defensepower <= 100) addstrAlt(CONST_justice124, gamelog);
		 else if (defensepower <= 150) addstrAlt(CONST_justice125, gamelog);
		 else
		 {
			 addstrAlt(CONST_justice126, gamelog);
			 addjuice(g, 50, 1000); // That shit is legend
		 }
		 gamelog.newline();
	 }
	 return defensepower;
 }
 bool pleadInnocent(DeprecatedCreature &g, DeprecatedCreature &sleeperLawyer, const char attorneyname[200], const LegalDefense defense, const bool sleeperjudge, const int scarefactor) {

	 // Show die rolls, 100% accurate poll numbers
	 extern bool SHOWMECHANICS;
	 extern Log gamelog;
	 DeprecatedCreature *sleeperlawyer = &sleeperLawyer;
	 int prosecution = 0;
	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK_BRIGHT);
	 mvaddstrAlt(1, 1, g.name, gamelog);
	 addstrAlt(CONST_justice090);
	 //TRIAL MESSAGE
	 set_color_easy(WHITE_ON_BLACK);
	 mvaddstrAlt(3, 1, CONST_justice091, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 //JURY MAKEUP MESSAGE
	 set_color_easy(WHITE_ON_BLACK);
	 moveAlt(5, 1);
	 int jury = LCSrandom(61) - (60 * publicmood(-1)) / 100; // Political leanings of the population determine your jury
	 if (sleeperjudge) jury -= 20;
	 if (defense == ACE_ATTORNEY) // Hired $5000 ace attorney
	 {
		 if (LCSrandom(10))
		 {
			 addstrAlt(attorneyname, gamelog);
			 addstrAlt(CONST_justice092, gamelog);
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice093, gamelog);
			 gamelog.newline();
			 if (jury > 0) jury = 0;
			 jury -= 30;
		 }
		 else
		 {
			 set_color_easy(RED_ON_BLACK_BRIGHT);
			 addstrAlt(attorneyname, gamelog);
			 addstrAlt(CONST_justice094, gamelog);
			 gamelog.newline();
			 jury = 0;
			 prosecution += 100; // DUN DUN DUN!!
		 }
	 }
	 else if (jury <= -29)
	 {
		 set_color_easy(GREEN_ON_BLACK_BRIGHT);
		 switch (LCSrandom(liberal_jury.size() + 1))
		 {
		 case 0:addstrAlt(g.name); addstrAlt(CONST_justice095, gamelog); break;
		 default:addstrAlt(pickrandom(liberal_jury), gamelog); break;
		 }
		 gamelog.newline();
	 }
	 else if (jury <= -15) addstrAlt(CONST_justice096, gamelog);
	 else if (jury < 15) addstrAlt(CONST_justice097, gamelog);
	 else if (jury < 29) addstrAlt(CONST_justice098, gamelog);
	 else
	 {
		 set_color_easy(YELLOW_ON_BLACK_BRIGHT);
		 addstrAlt(pickrandom(conservative_jury), gamelog);
	 }
	 gamelog.newline();
	 // Debug jury bias
	 if (SHOWMECHANICS)
	 {
		 addstrAlt(CONST_justice127);
		 if (jury >= 0) addcharAlt('+');
		 addstrAlt(jury);
		 addstrAlt(CONST_justice108);
	 }
	 pressAnyKey();
	 //PROSECUTION MESSAGE
	 // *JDS* The bigger your record, the stronger the evidence
	 prosecution += 40 + LCSrandom(101) + scarefactor + (20 * g.confessions);
	 if (sleeperjudge) prosecution >>= 1;
	 if (defense == ACE_ATTORNEY) prosecution -= 60;
	 set_color_easy(WHITE_ON_BLACK);
	 moveAlt(7, 1);

	 {
		 if (prosecution <= 50) addstrAlt(CONST_justice101, gamelog);
		 else if (prosecution <= 75) addstrAlt(CONST_justice102, gamelog);
		 else if (prosecution <= 125) addstrAlt(CONST_justice103, gamelog);
		 else if (prosecution <= 175) addstrAlt(CONST_justice104, gamelog);
		 else addstrAlt(CONST_justice105, gamelog);
		 gamelog.newline();
	 }
	 // Debug prosecution power
	 if (SHOWMECHANICS)
	 {
		 addstrAlt(CONST_justice106);
		 addstrAlt(prosecution / 2);
		 addstrAlt(CONST_justice107);
		 addstrAlt(prosecution);
		 addstrAlt(CONST_justice108);
	 }
	 pressAnyKey();
	 jury += LCSrandom(prosecution / 2 + 1) + prosecution / 2;
	 //DEFENSE MESSAGE
	 set_color_easy(WHITE_ON_BLACK);
	 moveAlt(9, 1);
	 int defensepower = get_defensepower(g, sleeperLawyer, attorneyname, defense, prosecution);

	 // Debug defense power
	 if (SHOWMECHANICS)
	 {
		 addstrAlt(CONST_justice127);
		 addstrAlt(defensepower);
		 addstrAlt(CONST_justice128);
		 addstrAlt(jury + 1);
		 addstrAlt(CONST_justice129);
	 }
	 pressAnyKey();
	 //DELIBERATION MESSAGE
	 set_color_easy(WHITE_ON_BLACK);
	 mvaddstrAlt(12, 1, CONST_justice130, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 //JURY RETURN MESSAGE
	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK);
	 mvaddstrAlt(1, 1, CONST_justice131, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 bool keeplawflags = false;
	 //HUNG JURY
	 if (defensepower == jury)
	 {
		 keeplawflags = hung_jury(g, sleeperjudge, scarefactor);
	 }
	 //ACQUITTAL!
	 else if (defensepower > jury)
	 {
		 acquittal(g, sleeperLawyer, defense, sleeperjudge);
	 }
	 //LENIENCE
	 else
	 {
		 // De-Juice sleeper
		 if (defense == SLEEPER_ATTORNEY) addjuice(*sleeperlawyer, -5, 0);
		 // Juice for getting convicted of something :)
		 addjuice(g, 25, 200);
		 // Check for lenience; sleeper judge will always be merciful
		 if (defensepower / 3 >= jury / 4 || sleeperjudge) penalize(g, 1);
		 else penalize(g, 0);
	 }

	 return keeplawflags;
 }
 void pleadGuilty(DeprecatedCreature &g, const bool sleeperjudge) {

	 extern Log gamelog;

	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK);
	 mvaddstrAlt(1, 1, CONST_justice143, gamelog);
	 gamelog.nextMessage();
	 pressAnyKey();
	 // Check for lenience; sleeper judge will always be merciful
	 if (sleeperjudge || LCSrandom(2)) penalize(g, 1);
	 else penalize(g, 0);

 }
 /* monthly - hold trial on a liberal */
 void trial(DeprecatedCreature &g)
 {
	 extern Log gamelog;
	 extern MusicClass music;
	 extern class Ledger ledger;
	 extern unsigned long attorneyseed[RNG_SIZE];
	 extern unsigned long seed[RNG_SIZE];
	 music.play(MUSIC_TRIAL);
	 // If their old base is no longer under LCS control, wander back to the
	 // homeless shelter instead.
	 if (LocationsPool::getInstance().get_specific_integer(INT_GETRENTINGTYPE,g.base) < 0) g.base = find_site_index_in_same_city(SITE_RESIDENTIAL_SHELTER, g.location);
	 g.location = g.base;
	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK_BRIGHT);
	 mvaddstrAlt(1, 1, g.name, gamelog);
	 addstrAlt(CONST_justice090, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 set_color_easy(WHITE_ON_BLACK);
	 if (!iscriminal(g)) criminalize(g, LAWFLAG_LOITERING);
	 int scarefactor = 0;
	 for (int i = 0; i < LAWFLAGNUM; i++) if (g.crimes_suspected[i])
	 {
		 scarefactor += scare_factor(i, g.crimes_suspected[i]);
	 }
	 //CHECK FOR SLEEPERS
	 DeprecatedCreature *sleeperjudge = getSleeperJudge(g);
	 DeprecatedCreature *sleeperlawyer = getSleeperLawyer(g);

	 //STATE CHARGES
	 set_color_easy(WHITE_ON_BLACK);
	 if (sleeperjudge)
	 {
		 mvaddstrAlt(3, 1, string_sleeper, gamelog);
		 addstrAlt(sleeperjudge->name, gamelog);
		 addstrAlt(CONST_justice037, gamelog);
		 g.confessions = 0; //Made sleeper judge prevent these lunatics from testifying
	 }
	 else mvaddstrAlt(3, 1, CONST_justice038, gamelog);
	 gamelog.newline();
	 set_color_easy(RED_ON_BLACK_BRIGHT);
	 mvaddstrAlt(5, 1, CONST_justice039, gamelog);
	 addstrAlt(g.propername, gamelog);
	 addstrAlt(CONST_justice040, gamelog);
	 int y = listAllCrimes(g);
	 gamelog.newline();
	 if (g.confessions)
	 {
		 if (g.confessions > 1)
		 {
			 mvaddstrAlt(y += 2, 1, g.confessions, gamelog);
			 addstrAlt(CONST_justice076, gamelog);
		 }
		 else mvaddstrAlt(y += 2, 1, CONST_justice077, gamelog);
		 addstrAlt(g.name, gamelog);
		 addstrAlt(singleDot, gamelog);
		 gamelog.newline();
		 pressAnyKey();
	 }
	 //CHOOSE DEFENSE
	 set_color_easy(WHITE_ON_BLACK);
	 mvaddstrAlt(y + 2, 1, CONST_justice078);
	 char attorneyname[200];
	 unsigned long oldseed[RNG_SIZE];
	 copyRNG(oldseed, seed);
	 copyRNG(seed, attorneyseed);
	 generate_name(attorneyname);
	 copyRNG(seed, oldseed);
	 y += 4;
	 mvaddstrAlt(y++, 1, CONST_justice079);
	 mvaddstrAlt(y++, 1, CONST_justice080);
	 mvaddstrAlt(y++, 1, CONST_justice081);
	 if (ledger.get_funds() < 5000) set_color_easy(BLACK_ON_BLACK_BRIGHT);
	 mvaddstrAlt(y++, 1, CONST_justice082);
	 addstrAlt(attorneyname);
	 addstrAlt(singleDot);
	 if (sleeperlawyer)
	 {
		 set_color_easy(WHITE_ON_BLACK);
		 mvaddstrAlt(y++, 1, CONST_justice083);
		 addstrAlt(sleeperlawyer->name);
		 addstrAlt(CONST_justice084);
	 }
	 if (ledger.get_funds() < 5000) set_color_easy(WHITE_ON_BLACK);
	 //SAV - added in display of skills and relevant attributes to help
	 // decide when to defend self.
	 mvaddstrAlt(++y, 5, CONST_justice085);
	 addstrAlt(g.get_attribute(ATTRIBUTE_HEART, true));
	 mvaddstrAlt(y, 25, CONST_justice086);
	 addstrAlt(g.get_skill(SKILL_PERSUASION));
	 mvaddstrAlt(++y, 5, CONST_justice087);
	 addstrAlt(g.get_attribute(ATTRIBUTE_CHARISMA, true));
	 mvaddstrAlt(y++, 25, CONST_justice088);
	 addstrAlt(g.get_skill(SKILL_LAW));
	 mvaddstrAlt(y++, 5, CONST_justice089);
	 addstrAlt(g.get_attribute(ATTRIBUTE_INTELLIGENCE, true));
	 // End SAV's adds
	 LegalDefense defense = UNDECIDED;
	 while (defense == UNDECIDED) {
		 int c = pressSpecificKey('a', 'b', 'c', 'd', 'e');

		 if (c == 'a') { defense = COURT_ATTORNEY; }
		 else
			 if (c == 'b') { defense = SELF_REPRESENT; }
			 else
				 if (c == 'c') { defense = PLEAD_GUILTY; }
				 else
					 if (c == 'd'&&ledger.get_funds() >= 5000)
					 {
						 ledger.subtract_funds(5000, EXPENSE_LEGAL);
						 defense = ACE_ATTORNEY;

					 }
					 else
						 if (c == 'e'&&sleeperlawyer)
						 {
							 defense = SLEEPER_ATTORNEY;
							 strcpy(attorneyname, sleeperlawyer->name);

						 }
	 }
	 //TRIAL
	 bool keeplawflags = false;
	 if (defense != PLEAD_GUILTY) { keeplawflags = pleadInnocent(g, *sleeperlawyer, attorneyname, defense, sleeperjudge, scarefactor); }
	 //GUILTY PLEA
	 // How about CONST_justice142 (Nolo contendere) -- LK
	 // I would imagine this would disregard the strength of the defense. -- LK
	 else { pleadGuilty(g, sleeperjudge); }

	 //CLEAN UP LAW FLAGS
	 if (!keeplawflags) for (int i = 0; i < LAWFLAGNUM; i++) g.crimes_suspected[i] = 0;
	 //Clean up heat, confessions
	 g.heat = 0, g.confessions = 0;
	 //PLACE PRISONER
	 if (g.sentence != 0) imprison(g);
	 else
	 {
		 Armor clothes(getarmortype(tag_ARMOR_CLOTHES));
		 g.give_armor(clothes, NULL);
	 }
 }
 void reeducation(DeprecatedCreature &g)
 {
	 extern Log gamelog;
	 extern vector<DeprecatedCreature *> pool;
	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK_BRIGHT);
	 mvaddstrAlt(8, 1, g.name, gamelog);
	 addstrAlt(pickrandom(reeducation_experiences), gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 moveAlt(10, 1);
	 if (!g.attribute_check(ATTRIBUTE_HEART, DIFFICULTY_FORMIDABLE))
	 {
		 if (g.juice > 0 && LCSrandom(2))
		 {
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice144, gamelog);
			 addjuice(g, -50, 0);
		 }
		 else if (LCSrandom(15) > g.get_attribute(ATTRIBUTE_WISDOM, true)
			 || g.get_attribute(ATTRIBUTE_WISDOM, true) < g.get_attribute(ATTRIBUTE_HEART, true))
		 {
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice145, gamelog);
			 g.adjust_attribute(ATTRIBUTE_WISDOM, +1);
		 }
		 else if (g.align == ALIGN_LIBERAL && g.flag & CREATUREFLAG_LOVESLAVE && LCSrandom(4))
		 {
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice146, gamelog);
			 addstrAlt(pool[g.hireid]->name, gamelog);
			 addstrAlt(singleDot, gamelog);
		 }
		 else
		 {
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice147, gamelog);
			 //Rat out contact
			 int contact = getpoolcreature(g.hireid);
			 if (contact >= 0)
			 {
				 criminalize(*pool[contact], LAWFLAG_RACKETEERING);
				 pool[contact]->confessions++;
			 }
			 g.die();
			 g.location = -1;
		 }
	 }
	 else
	 {
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice148, gamelog);
	 }
	 gamelog.nextMessage();
	 pressAnyKey();
	 eraseAlt();
	 return;
 }
 void laborcamp(DeprecatedCreature &g)
 {
	 extern Log gamelog;
	 int escaped = 0;
	 const char *experience;
	 // Escape attempt!
	 if (g.hireid == -1 && !LCSrandom(3))
	 {
		 escaped = 2;
		 experience = CONST_justice149.c_str();
	 }
	 else if (g.skill_check(SKILL_DISGUISE, DIFFICULTY_HEROIC) && !LCSrandom(10))
	 {
		 escaped = 1;
		 experience = CONST_justice150.c_str();
		 g.give_armor(getarmortype(tag_ARMOR_WORKCLOTHES), NULL);
	 }
	 else if (g.skill_check(SKILL_SECURITY, DIFFICULTY_CHALLENGING) && g.skill_check(SKILL_STEALTH, DIFFICULTY_HARD) && !LCSrandom(10))
	 {
		 escaped = 1;
		 experience = CONST_justice151.c_str();
	 }
	 else if (g.skill_check(SKILL_SCIENCE, DIFFICULTY_HARD) && !LCSrandom(10))
	 {
		 escaped = 1;
		 experience = CONST_justice152.c_str();
	 }
	 if (!escaped)experience = (singleSpace + pickrandom(labor_camp_experiences)).data();
	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK_BRIGHT);
	 mvaddstrAlt(8, 1, g.name, gamelog);
	 addstrAlt(experience, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 moveAlt(10, 1);
	 if (escaped)
	 {
		 int prison = g.location;
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice164, gamelog);
		 addjuice(g, 50, 1000);
		 criminalize(g, LAWFLAG_ESCAPED);
		 g.location = find_site_index_in_same_city(SITE_RESIDENTIAL_SHELTER, g.location);
		 if (escaped == 2)
		 {
			 int num_escaped = otherPrisonersEscapeWithMe(g, prison);
			 if (num_escaped == 1)
			 {
				 gamelog.nextMessage();
				 mvaddstrAlt(11, 1, CONST_justice165, gamelog);
			 }
			 else if (num_escaped > 1)
			 {
				 gamelog.nextMessage();
				 mvaddstrAlt(11, 1, CONST_justice166, gamelog);
			 }
		 }
	 }
	 else if (!LCSrandom(4))
	 {
		 if (g.get_attribute(ATTRIBUTE_HEALTH, true) > 1)
		 {
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice156, gamelog);
			 addjuice(g, -40, 0);
			 addjuice(g, -10, -50);
		 }
		 else
		 {
			 addstrAlt(g.name, gamelog);
			 addstrAlt(CONST_justice157, gamelog);
			 g.die();
			 g.location = -1;
		 }
	 }
	 else
	 {
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice158, gamelog);
	 }
	 gamelog.nextMessage();
	 pressAnyKey();
	 eraseAlt();
	 return;
 }
 void prisonscene(DeprecatedCreature &g)
 {
	 extern Log gamelog;
	 extern vector<DeprecatedCreature *> pool;
	 int escaped = 0;
	 int effect = 0;
	 const char *experience;
	 if (g.juice + int(g.hireid == -1) * 300 > 500)
	 {
		 // Escape attempt!
		 if (g.hireid == -1 && !LCSrandom(10))
		 {
			 escaped = 2;
			 experience = CONST_justice159.c_str();
		 }
		 else if (g.skill_check(SKILL_COMPUTERS, DIFFICULTY_HARD) && !LCSrandom(5))
		 {
			 escaped = 2;
			 experience = CONST_justice160.c_str();
		 }
		 else if (g.skill_check(SKILL_DISGUISE, DIFFICULTY_HARD) && !LCSrandom(5))
		 {
			 escaped = 1;
			 experience = CONST_justice161.c_str();
			 g.give_armor(getarmortype(tag_ARMOR_CLOTHES), NULL);
		 }
		 else if (g.skill_check(SKILL_SECURITY, DIFFICULTY_CHALLENGING) && g.skill_check(SKILL_STEALTH, DIFFICULTY_CHALLENGING) && !LCSrandom(5))
		 {
			 escaped = 1;
			 experience = CONST_justice162.c_str();
		 }
		 else if (g.skill_check(SKILL_SCIENCE, DIFFICULTY_AVERAGE) && g.skill_check(SKILL_HANDTOHAND, DIFFICULTY_EASY) && !LCSrandom(5))
		 {
			 escaped = 1;
			 experience = CONST_justice163.c_str();
		 }
	 }
	 if (escaped == 0)
	 {
		 if (g.attribute_check(ATTRIBUTE_HEART, DIFFICULTY_HARD)) {
			 effect = 1;
			 if (LCSrandom(2) > 0) experience = (singleSpace + pickrandom(good_experiences)).data();
			 else experience = (singleSpace + pickrandom(general_experiences)).data();
		 }
		 else if (g.attribute_check(ATTRIBUTE_HEART, DIFFICULTY_CHALLENGING)) {
			 effect = 0;
			 experience = (singleSpace + pickrandom(general_experiences)).data();
		 }
		 else {
			 effect = -1;
			 if (LCSrandom(2) > 0) experience = (singleSpace + pickrandom(bad_experiences)).data();
			 else experience = (singleSpace + pickrandom(general_experiences)).data();
		 }
	 }
	 eraseAlt();
	 set_color_easy(WHITE_ON_BLACK_BRIGHT);
	 mvaddstrAlt(8, 1, g.name, gamelog);
	 addstrAlt(experience, gamelog);
	 gamelog.newline();
	 pressAnyKey();
	 moveAlt(10, 1);
	 if (escaped)
	 {
		 int prison = g.location;
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice164, gamelog);
		 addjuice(g, 50, 1000);
		 criminalize(g, LAWFLAG_ESCAPED);
		 g.location = find_site_index_in_same_city(SITE_RESIDENTIAL_SHELTER, g.location);
		 if (escaped == 2)
		 {
			 int num_escaped = 0;
			 for (int p = 0; p < CreaturePool::getInstance().lenpool(); p++)
			 {
				 if (pool[p]->location == prison && !(pool[p]->flag & CREATUREFLAG_SLEEPER))
				 {
					 criminalize(*pool[p], LAWFLAG_ESCAPED);
					 pool[p]->location = g.location;
					 num_escaped++;
				 }
			 }
			 if (num_escaped == 1)
			 {
				 gamelog.nextMessage();
				 mvaddstrAlt(11, 1, CONST_justice165, gamelog);
			 }
			 else if (num_escaped > 1)
			 {
				 gamelog.nextMessage();
				 mvaddstrAlt(11, 1, CONST_justice166, gamelog);
			 }
		 }
	 }
	 else if (effect > 0)
	 {
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice167, gamelog);
		 addjuice(g, 20, 1000);
	 }
	 else if (effect < 0)
	 {
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice168, gamelog);
		 addjuice(g, -20, -30);
	 }
	 else
	 {
		 addstrAlt(g.name, gamelog);
		 addstrAlt(CONST_justice169, gamelog);
	 }
	 gamelog.nextMessage();
	 pressAnyKey();
	 eraseAlt();
	 return;
 }
 /* monthly - advances a liberal's prison time or executes them */
 //RETURNS IF SCREEN WAS ERASED
 char prison(DeprecatedCreature &g)
 {
	 extern Log gamelog;
	 extern int stat_dead;
	 extern short lawList[LAWNUM];
	 extern vector<DeprecatedCreature *> pool;
	 char showed = 0;
	 // People not on death row or about to be released can have a scene in prison
	 if (!g.deathpenalty && g.sentence != 1)
	 {
		 if (lawList[LAW_PRISONS] == 2)
		 {
			 //Liberal therapy.
			 if (!LCSrandom(5)) reeducation(g);
		 }
		 else if (lawList[LAW_PRISONS] == -2)
		 {
			 //Labor camp.
			 if (!LCSrandom(5)) laborcamp(g);
		 }
		 else
		 {
			 //Normal prison.
			 if (!LCSrandom(5)) prisonscene(g);
		 }
	 }
	 if (g.sentence > 0)
	 {
		 //COMMUTE DEATH IN RIGHT CLIMATE
		 if (g.deathpenalty&&lawList[LAW_DEATHPENALTY] == 2)
		 {
			 eraseAlt();
			 set_color_easy(WHITE_ON_BLACK);
			 mvaddstrAlt(8, 1, g.name, gamelog);
			 addstrAlt(CONST_justice170, gamelog);
			 mvaddstrAlt(9, 1, CONST_justice171, gamelog);
			 gamelog.nextMessage();
			 pressAnyKey();
			 g.sentence = -1;
			 g.deathpenalty = 0;
			 return 1;
		 }
		 //ADVANCE SENTENCE
		 g.sentence--;
		 if (g.sentence == 0)
		 {
			 //EXECUTE
			 if (g.deathpenalty)
			 {
				 eraseAlt();
				 set_color_easy(RED_ON_BLACK_BRIGHT);
				 mvaddstrAlt(8, 1, CONST_justice172, gamelog);
				 gamelog.newline();
				 mvaddstrAlt(9, 1, CONST_justice173, gamelog);
				 addstrAlt(g.name, gamelog);
				 gamelog.record(singleSpace); //Log this for formatting purposes.
				 mvaddstrAlt(10, 1, CONST_justice174, gamelog);
				 if (lawList[LAW_DEATHPENALTY] == -2)
					 addstrAlt(pickrandom(cruel_and_unusual_execution_methods), gamelog);
				 else if (lawList[LAW_DEATHPENALTY] == -1 || lawList[LAW_DEATHPENALTY] == 0)
					 addstrAlt(pickrandom(standard_execution_methods), gamelog);
				 else
					 addstrAlt(pickrandom(supposedly_painless_execution_method), gamelog);
				 addstrAlt(singleDot, gamelog);
				 pressAnyKey();
				 //dejuice boss
				 int boss = getpoolcreature(g.hireid);
				 if (boss != -1)
				 {
					 gamelog.newline();
					 set_color_easy(WHITE_ON_BLACK);
					 mvaddstrAlt(12, 1, pool[boss]->name, gamelog);
					 addstrAlt(CONST_justice175, gamelog);
					 gamelog.newline();
					 mvaddstrAlt(14, 1, CONST_justice176, gamelog);
					 pressAnyKey();
					 addjuice(*pool[boss], -50, -50);
				 }
				 gamelog.nextMessage();
				 g.die();
				 stat_dead++;
				 showed = 1;
			 }
			 //SET FREE
			 else
			 {
				 eraseAlt();
				 set_color_easy(WHITE_ON_BLACK);
				 mvaddstrAlt(8, 1, g.name, gamelog);
				 addstrAlt(CONST_justice177, gamelog);
				 gamelog.newline();
				 mvaddstrAlt(9, 1, CONST_justice178, gamelog);
				 gamelog.nextMessage();
				 pressAnyKey();
				 Armor clothes(getarmortype(tag_ARMOR_CLOTHES));
				 g.give_armor(clothes, NULL);
				 // If their old base is no longer under LCS control, wander back to the
				 // homeless shelter instead.
				 if (LocationsPool::getInstance().get_specific_integer(INT_GETRENTINGTYPE,g.base) < 0) g.base = find_site_index_in_same_city(SITE_RESIDENTIAL_SHELTER, g.location);
				 g.location = g.base;
				 showed = 1;
			 }
		 }
		 //NOTIFY OF IMPENDING THINGS
		 else if (g.sentence == 1)
		 {
			 if (g.deathpenalty)
			 {
				 eraseAlt();
				 set_color_easy(YELLOW_ON_BLACK_BRIGHT);
				 mvaddstrAlt(8, 1, g.name, gamelog);
				 addstrAlt(CONST_justice179, gamelog);
				 gamelog.nextMessage();
				 pressAnyKey();
				 showed = 1;
			 }
			 else
			 {
				 eraseAlt();
				 set_color_easy(WHITE_ON_BLACK_BRIGHT);
				 mvaddstrAlt(8, 1, g.name, gamelog);
				 addstrAlt(CONST_justice180, gamelog);
				 gamelog.nextMessage();
				 pressAnyKey();
				 showed = 1;
			 }
		 }
		 else
		 {
			 if (g.deathpenalty)
			 {
				 eraseAlt();
				 set_color_easy(YELLOW_ON_BLACK_BRIGHT);
				 mvaddstrAlt(8, 1, g.name, gamelog);
				 addstrAlt(CONST_justice181, gamelog);
				 addstrAlt(g.sentence, gamelog);
				 addstrAlt(CONST_justice182, gamelog);
				 gamelog.nextMessage();
				 pressAnyKey();
				 showed = 1;
			 }
		 }
	 }
	 return showed;
 }
